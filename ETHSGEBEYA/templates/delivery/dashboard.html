{% extends 'ethsgebeya/base.html' %}
{% block content %}
<h2>Courier Dashboard</h2>
<div class="d-flex justify-content-between align-items-center mb-3">
  <p class="m-0">Assigned deliveries:</p>
  <a href="{% url 'available_deliveries' %}" class="btn btn-outline-primary btn-sm">Find Available Jobs</a>
</div>
<table class="table">
  <thead>
    <tr>
      <th>Tracking</th>
      <th>Order</th>
      <th>Seller</th>
      <th>Pickup</th>
      <th>Dropoff</th>
      <th>Status</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
  {% for d in deliveries %}
    <tr>
      <td>{{ d.tracking_code }}</td>
      <td>#{{ d.order.id }} - {{ d.order.product.title }}</td>
      <td>{{ d.order.product.seller.company_name }}</td>
      <td>{{ d.pickup_address|default:'-' }}</td>
      <td>{{ d.delivery_address|default:'-' }}</td>
      <td>{{ d.get_status_display }}</td>
      <td>
        <form method="post" action="{% url 'update_delivery_status' d.id %}">
          {% csrf_token %}
          <div class="btn-group btn-group-sm" role="group">
            <button name="action" value="en_route" class="btn btn-outline-primary">En Route</button>
            <button name="action" value="picked_up" class="btn btn-outline-primary">Picked Up</button>
            <button name="action" value="out_for_delivery" class="btn btn-outline-primary">Out for Delivery</button>
            <button name="action" value="delivered" class="btn btn-success">Delivered</button>
            <button name="action" value="failed" class="btn btn-danger">Failed</button>
          </div>
        </form>
      </td>
    </tr>
  {% empty %}
    <tr><td colspan="7">No assigned deliveries</td></tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
